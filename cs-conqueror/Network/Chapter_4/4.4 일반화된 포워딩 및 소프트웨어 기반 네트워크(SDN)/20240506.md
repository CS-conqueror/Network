# 4.4 일반화된 포워딩 및 소프트웨어 기반 네트워크(SDN)

[4.4.1] 매치 </br>
[4.4.2] 액션 </br>
[4.4.3] 매치 플러스 액션 작업의 OpenFlow 예 </br>

</br>
</br>

> 목적지 IP 주소를 찾은('매치')후 패킷을 스위치 구조로 지정된 출럭 포르토 전송('액션') 하는 두단계의 목적지 기반 포워딩을 4.2.1절에서 설명했다.

프로토콜 스택의 다른 계층에서 다른 프로토콜과 관련된 여러 헤더 필드에 대해 `매치`를 수행할 수 있는 일반적인 `매치 플러스 액션` 방법을 생각해보자.

`액션`은 하나 이상의 출력 포트로 패킷을 전달하고, 인터페이스에서 나가는 패킷을 로드 밸런싱(load balancing)하고 헤더값을 다시 쓰고, 의도적으로 패킷을 차단/삭제 및 추가 처리 작업을 위해 특수 서버로 패킷을 보내는 등의 작업을 수행한다.</br>
+) 로드 밸런싱 : 네트워크나 컴퓨팅 시스템에서 발생하는 작업이나 트래픽을 여러 대의 서버나 네트워크 장비로 분산시켜 성능을 최적화하는 기술.

일반화된 <ins>포워딩에서는 각각의 패킷 스위치는 원격 컨트롤러에 의해 계산 및 분포된 `매치 플러스 액션 테이블`을 포함</ins>하고 있다.

<p align="center"><img width="500" alt="일반화된 포워딩" src="https://user-images.githubusercontent.com/76640167/212715327-0ef5af73-4e96-4ee4-bdba-138c23bf6312.png">

위 그림은 `매치 플러스 액션 테이블`을 보여주며, 테이블은 원격 컨트롤러를 통해 계산, 설치, 갱신된다. 

</br>

### 일반화된 포워딩 : OpenFlow 1.0

OpenFlow는 SDN(소프트웨어 정의 네트워킹)의 개념을 도입한 프로토콜 중 하나로, 

네트워크 간의 통신과 제어를 중앙 집중식으로 관리한다.

이를 통해 네트워크 관리자는 네트워크 동작을 프로그래밍적으로 제어할 수 있다.

일반화된 포워딩의 `매치 플러스 액션 테이블`은 목적지 기반 포워딩 테이블의 개념을 일반화한다.

</br>

### Flow Table

OpenFlow의 `매치 플러스 액션 포워딩 테이블`을 부르는 용어

**플로우의 각 엔트리가 포함하는 특성**
- 들어오는 패킷에 대한 `헤더값`들의 세트가 매치될 것이다.
  - 하드웨어 기반 매치는 TCAM 메모리에서 가장 신속하게 수행
  - 백만 개가 넘는 목적지 주소를 동반
  - 플로우 테이블 엔트리와 매치되지 않는 패킷은 원격 컨트롤러로 전송 가능(처리율 증가) 
- 패킷들에 의해 갱신되는 `카운터 세트`는 플로우 테이블 엔트리들과 매치된다.
  - 카운터는 플로우 테이블 엔트리와 마지막으로 갱신된 테이블 엔트리 이후에 매치된 다수의 패킷을 포함하고 있다.
- 패킷이 플로우 테이블 엔트리와 매치될 때 여러 가지 `액션`이 가능해진다.
  - 패킷을 지정된 출력 포트로 전달
  - 패킷을 삭제
  - 패킷의 복사본을 만들어 여러 출력 포트로 보냄.

</br>
</br>
</br>

## 4.4.1 매치
<p align="center"><img width="700" alt="매치 인 액션 매치" src="https://user-images.githubusercontent.com/76640167/213117975-972cdf56-575f-4e0d-b9b2-662f3ea2278f.png">

위 그림은 OpenFlow 1.0 `매치 플러스 액션` 규칙에서 매치될 수 있는 11개의 패킷 헤더 필드와 수신 포트 ID를 보여준다.

`출발지 및 목적지 MAC 주소 필드` 
- 프레임 송신 및 수신 인터페이스와 연관된 링크 계층 주소.
- IP 주소가 아닌 이더넷 주소를 기반으로 전달함.

`이더넷 타입 필드`
- 상위 계층의 프로토콜, 즉 프레임의 페이로드가 역 다중화되는 프로토콜
- 

